@using AasxServerBlazor.TreeVisualisation
@using Extensions
@using AasxServer

@namespace AasxServerBlazor.Pages.TreeNodeComponents

<div class="node-element-container" id="basic-event-component">
    @if (SelectedNode?.Tag is BasicEventElement {Observed: not null} basicEventElement)
    {
        var observedEventElementKey = basicEventElement.Observed.GetAsExactlyOneKey().ToStringExtended();

        <span class="observed-event">@("Observed " + observedEventElementKey)</span>
        <br/>

        var referableEventOfAasEnvironment = Program.env[0].AasEnv.FindReferableByReference(basicEventElement.Observed);
        if (referableEventOfAasEnvironment != null)
        {
            <span class="update-timestamp">UPDATE @referableEventOfAasEnvironment.TimeStamp.ToString(TimeFormat)</span>
            <br/>
            <span class="create-timestamp">CREATE @referableEventOfAasEnvironment.TimeStampCreate.ToString(TimeFormat)</span>
            <br/>
        }
        else
        {
            <span class="error-message">Referenced element does not exist!</span>
            <br/>
        }
    }
</div>

@code {
    [Parameter] public TreeItem SelectedNode { get; set; }
    private const string TimeFormat = "yy-MM-dd HH:mm:ss.fff";
}
